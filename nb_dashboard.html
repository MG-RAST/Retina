<!DOCTYPE HTML>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KBase iPyNB</title>
    
    <!--external javascript files-->
    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="js/jquery-ui.min.js"></script>
    <script type="text/javascript" src="js/bootstrap.min.js"></script>
    
    <!--basic javascript files-->
    <script type="text/javascript" src="js/stm.js"></script>
    <script type="text/javascript" src="js/retina.js"></script>
    
    <!--style-->
    <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
    
    <!--initialization-->
    <script type="text/javascript">
    jQuery(function () {
      	stm.init('http://api.metagenomics.anl.gov/api2.cgi').then(function() {
	    Retina.init({ library_resource: "js/" });
      	    Retina.add_renderer({"name": "listselect", "resource": "renderers/", "filename": "renderer.listselect.js"});
      	    Retina.add_renderer({"name": "graph", "resource": "renderers/", "filename": "renderer.graph.js"});
      	    Retina.add_renderer({"name": "table", "resource": "renderers/", "filename": "renderer.table.js"});
      	    Retina.add_renderer({"name": "paragraph", "resource": "renderers/", "filename": "renderer.paragraph.js"});
	    Retina.add_widget({"name": "NotebookDashboard", "resource": "widgets/", "filename": "widget.NotebookDashboard.js"});
	    Retina.add_widget({"name": "VisualPython", "resource": "widgets/", "filename": "widget.VisualPython.js"});

      	    Retina.load_widget("NotebookDashboard").then( function () {
		Retina.load_widget("VisualPython").then( function () {
		    Retina.Widget.create('NotebookDashboard', { target: "dashboard", notebook: "nb_iframe" });	
		});
	    });
      	});
    });
    </script>
    
  </head>
  
  <body style="margin-top: 60px;">
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
	    <div class="container" style="width: 100%; padding-left: 10px;">
          <img src="images/KbaseLogoTransparent.gif" style="float: left; background: white; margin-left: -10px; height: 55px;">
    	  <a class="brand" href="#" style="color: white; cursor:
    default; margin-top: 8px; margin-left: 30px;">iPyNB - The KBase iPython Notebook</a>
	    </div>
      </div>
    </div>
    
    <div id="dashboard"></div>
    <div id="nb_iframe"></div>
    <button class="btn btn-success" onclick="export_visual();" title="show results in new window" style="position: absolute; top: 60px; right: 10px;"><i class="icon-eye-open icon-white"></i></button>
    <script>
    function export_visual() {
	if (document.getElementById('result').innerHTML == "") {
	    alert("There is no content to show.");
	} else {
	    var w = window.open('', '_blank', '');
	    w.document.open();
	    w.document.write("<html><head><title>Notebook Analysis Result</title><link rel='stylesheet' type='text/css' href='css/bootstrap.min.css'><style>body div { margin-bottom: 30px; }</style></head><body class='container' style='margin-top: 50px;'></body></html>");
	    w.document.body.innerHTML = document.getElementById('result').innerHTML;
	    w.document.close();
	}
    }
    </script>
  </body>
</html>
